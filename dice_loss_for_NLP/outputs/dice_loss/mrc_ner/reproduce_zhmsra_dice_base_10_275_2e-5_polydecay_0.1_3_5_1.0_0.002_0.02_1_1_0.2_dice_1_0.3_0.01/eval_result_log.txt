2021-04-11 22:35:17,575 - __main__ - Namespace(accelerator=None, accumulate_grad_batches=3, activate_func='relu', adam_epsilon=1e-06, amp_backend='native', amp_level='O2', answerable_only=False, answerable_task_ratio=0.3, auto_lr_find=False, auto_scale_batch_size=False, auto_select_gpus=False, automatic_optimization=None, benchmark=False, bert_config_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/cached_models/bert-base-uncased', bert_hidden_dropout=0.1, cache_dir='', check_val_every_n_epoch=1, checkpoint_callback=True, construct_entity_span='start_and_end', data_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/datasets/ace2004', data_sign='zh_msra', debug=False, default_root_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', deterministic=False, dice_alpha=0.01, dice_ohem=0.3, dice_smooth=1.0, dice_square=True, distributed_backend=None, do_lower_case=False, enable_pl_optimizer=None, eval_batch_size=1, fast_dev_run=False, final_div_factor=10000.0, flat_ner=True, flush_logs_every_n_steps=100, focal_alpha=None, focal_gamma=2, gpus=1, gradient_clip_val=1.0, is_chinese=True, limit_predict_batches=1.0, limit_test_batches=1.0, limit_train_batches=1.0, limit_val_batches=1.0, log_every_n_steps=50, log_gpu_memory=None, logger=True, loss_dynamic=False, loss_type='dice', lr=2e-05, lr_scheduler='polydecay', max_epochs=5, max_keep_ckpt=20, max_length=275, max_steps=None, min_epochs=None, min_steps=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', negative_sampling=False, num_labels=1, num_nodes=1, num_processes=1, num_sanity_val_steps=2, only_keep_the_best_ckpt_after_training=False, optimizer='torch.adam', output_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', overfit_batches=0.0, overwrite_cache=False, plugins=None, precision=16, pred_answerable=True, prepare_data_per_node=True, pretrained_checkpoint='', process_position=0, profiler=None, progress_bar_refresh_rate=1, reload_dataloaders_every_epoch=False, replace_sampler_ddp=True, resume_from_checkpoint=None, save_predictions_to_file=False, seed=2333, span_loss_candidates='gold_pred_random', stochastic_weight_avg=False, sync_batchnorm=False, terminate_on_nan=False, tpu_cores=<function _gpus_arg_default at 0x7fb1526e3ca0>, track_grad_norm=-1, train_batch_size=10, truncated_bptt_steps=None, val_check_interval=0.25, warmup_proportion=0.02, weight_decay=0.002, weight_end=1.0, weight_span=0.2, weight_start=1.0, weights_save_path=None, weights_summary='top', workers=0)
2021-04-11 22:35:28,359 - __main__ - Namespace(accelerator=None, accumulate_grad_batches=3, activate_func='relu', adam_epsilon=1e-06, amp_backend='native', amp_level='O2', answerable_only=False, answerable_task_ratio=0.3, auto_lr_find=False, auto_scale_batch_size=False, auto_select_gpus=False, automatic_optimization=None, benchmark=False, bert_config_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/cached_models/bert-base-uncased', bert_hidden_dropout=0.1, cache_dir='', check_val_every_n_epoch=1, checkpoint_callback=True, construct_entity_span='start_and_end', data_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/datasets/ace2004', data_sign='zh_msra', debug=False, default_root_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', deterministic=False, dice_alpha=0.01, dice_ohem=0.3, dice_smooth=1.0, dice_square=True, distributed_backend=None, do_lower_case=False, enable_pl_optimizer=None, eval_batch_size=1, fast_dev_run=False, final_div_factor=10000.0, flat_ner=True, flush_logs_every_n_steps=100, focal_alpha=None, focal_gamma=2, gpus=1, gradient_clip_val=1.0, is_chinese=True, limit_predict_batches=1.0, limit_test_batches=1.0, limit_train_batches=1.0, limit_val_batches=1.0, log_every_n_steps=50, log_gpu_memory=None, logger=True, loss_dynamic=False, loss_type='dice', lr=2e-05, lr_scheduler='polydecay', max_epochs=5, max_keep_ckpt=20, max_length=275, max_steps=None, min_epochs=None, min_steps=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', negative_sampling=False, num_labels=1, num_nodes=1, num_processes=1, num_sanity_val_steps=2, only_keep_the_best_ckpt_after_training=False, optimizer='torch.adam', output_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', overfit_batches=0.0, overwrite_cache=False, plugins=None, precision=16, pred_answerable=True, prepare_data_per_node=True, pretrained_checkpoint='', process_position=0, profiler=None, progress_bar_refresh_rate=1, reload_dataloaders_every_epoch=False, replace_sampler_ddp=True, resume_from_checkpoint=None, save_predictions_to_file=False, seed=2333, span_loss_candidates='gold_pred_random', stochastic_weight_avg=False, sync_batchnorm=False, terminate_on_nan=False, tpu_cores=<function _gpus_arg_default at 0x7f4b16b26ca0>, track_grad_norm=-1, train_batch_size=10, truncated_bptt_steps=None, val_check_interval=0.25, warmup_proportion=0.02, weight_decay=0.002, weight_end=1.0, weight_span=0.2, weight_start=1.0, weights_save_path=None, weights_summary='top', workers=0)
2021-04-11 22:35:37,544 - __main__ - Namespace(accelerator=None, accumulate_grad_batches=3, activate_func='relu', adam_epsilon=1e-06, amp_backend='native', amp_level='O2', answerable_only=False, answerable_task_ratio=0.3, auto_lr_find=False, auto_scale_batch_size=False, auto_select_gpus=False, automatic_optimization=None, benchmark=False, bert_config_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/cached_models/bert-base-uncased', bert_hidden_dropout=0.1, cache_dir='', check_val_every_n_epoch=1, checkpoint_callback=True, construct_entity_span='start_and_end', data_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/datasets/ace2004', data_sign='zh_msra', debug=False, default_root_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', deterministic=False, dice_alpha=0.01, dice_ohem=0.3, dice_smooth=1.0, dice_square=True, distributed_backend=None, do_lower_case=False, enable_pl_optimizer=None, eval_batch_size=1, fast_dev_run=False, final_div_factor=10000.0, flat_ner=True, flush_logs_every_n_steps=100, focal_alpha=None, focal_gamma=2, gpus=0, gradient_clip_val=1.0, is_chinese=True, limit_predict_batches=1.0, limit_test_batches=1.0, limit_train_batches=1.0, limit_val_batches=1.0, log_every_n_steps=50, log_gpu_memory=None, logger=True, loss_dynamic=False, loss_type='dice', lr=2e-05, lr_scheduler='polydecay', max_epochs=5, max_keep_ckpt=20, max_length=275, max_steps=None, min_epochs=None, min_steps=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', negative_sampling=False, num_labels=1, num_nodes=1, num_processes=1, num_sanity_val_steps=2, only_keep_the_best_ckpt_after_training=False, optimizer='torch.adam', output_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', overfit_batches=0.0, overwrite_cache=False, plugins=None, precision=16, pred_answerable=True, prepare_data_per_node=True, pretrained_checkpoint='', process_position=0, profiler=None, progress_bar_refresh_rate=1, reload_dataloaders_every_epoch=False, replace_sampler_ddp=True, resume_from_checkpoint=None, save_predictions_to_file=False, seed=2333, span_loss_candidates='gold_pred_random', stochastic_weight_avg=False, sync_batchnorm=False, terminate_on_nan=False, tpu_cores=<function _gpus_arg_default at 0x7fd83776aca0>, track_grad_norm=-1, train_batch_size=10, truncated_bptt_steps=None, val_check_interval=0.25, warmup_proportion=0.02, weight_decay=0.002, weight_end=1.0, weight_span=0.2, weight_start=1.0, weights_save_path=None, weights_summary='top', workers=0)
2021-04-11 22:35:44,765 - __main__ - Namespace(accelerator=None, accumulate_grad_batches=3, activate_func='relu', adam_epsilon=1e-06, amp_backend='native', amp_level='O2', answerable_only=False, answerable_task_ratio=0.3, auto_lr_find=False, auto_scale_batch_size=False, auto_select_gpus=False, automatic_optimization=None, benchmark=False, bert_config_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/cached_models/bert-base-uncased', bert_hidden_dropout=0.1, cache_dir='', check_val_every_n_epoch=1, checkpoint_callback=True, construct_entity_span='start_and_end', data_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/datasets/ace2004', data_sign='zh_msra', debug=False, default_root_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', deterministic=False, dice_alpha=0.01, dice_ohem=0.3, dice_smooth=1.0, dice_square=True, distributed_backend=None, do_lower_case=False, enable_pl_optimizer=None, eval_batch_size=1, fast_dev_run=False, final_div_factor=10000.0, flat_ner=True, flush_logs_every_n_steps=100, focal_alpha=None, focal_gamma=2, gpus=0, gradient_clip_val=1.0, is_chinese=True, limit_predict_batches=1.0, limit_test_batches=1.0, limit_train_batches=1.0, limit_val_batches=1.0, log_every_n_steps=50, log_gpu_memory=None, logger=True, loss_dynamic=False, loss_type='dice', lr=2e-05, lr_scheduler='polydecay', max_epochs=5, max_keep_ckpt=20, max_length=275, max_steps=None, min_epochs=None, min_steps=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', negative_sampling=False, num_labels=1, num_nodes=1, num_processes=1, num_sanity_val_steps=2, only_keep_the_best_ckpt_after_training=False, optimizer='torch.adam', output_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', overfit_batches=0.0, overwrite_cache=False, plugins=None, precision=16, pred_answerable=True, prepare_data_per_node=True, pretrained_checkpoint='', process_position=0, profiler=None, progress_bar_refresh_rate=1, reload_dataloaders_every_epoch=False, replace_sampler_ddp=True, resume_from_checkpoint=None, save_predictions_to_file=False, seed=2333, span_loss_candidates='gold_pred_random', stochastic_weight_avg=False, sync_batchnorm=False, terminate_on_nan=False, tpu_cores=<function _gpus_arg_default at 0x7f37e4ba0ca0>, track_grad_norm=-1, train_batch_size=10, truncated_bptt_steps=None, val_check_interval=0.25, warmup_proportion=0.02, weight_decay=0.002, weight_end=1.0, weight_span=0.2, weight_start=1.0, weights_save_path=None, weights_summary='top', workers=0)
2021-04-11 22:35:50,075 - __main__ - Namespace(accelerator=None, accumulate_grad_batches=3, activate_func='relu', adam_epsilon=1e-06, amp_backend='native', amp_level='O2', answerable_only=False, answerable_task_ratio=0.3, auto_lr_find=False, auto_scale_batch_size=False, auto_select_gpus=False, automatic_optimization=None, benchmark=False, bert_config_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/cached_models/bert-base-uncased', bert_hidden_dropout=0.1, cache_dir='', check_val_every_n_epoch=1, checkpoint_callback=True, construct_entity_span='start_and_end', data_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/datasets/ace2004', data_sign='zh_msra', debug=False, default_root_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', deterministic=False, dice_alpha=0.01, dice_ohem=0.3, dice_smooth=1.0, dice_square=True, distributed_backend=None, do_lower_case=False, enable_pl_optimizer=None, eval_batch_size=1, fast_dev_run=False, final_div_factor=10000.0, flat_ner=True, flush_logs_every_n_steps=100, focal_alpha=None, focal_gamma=2, gpus='0,', gradient_clip_val=1.0, is_chinese=True, limit_predict_batches=1.0, limit_test_batches=1.0, limit_train_batches=1.0, limit_val_batches=1.0, log_every_n_steps=50, log_gpu_memory=None, logger=True, loss_dynamic=False, loss_type='dice', lr=2e-05, lr_scheduler='polydecay', max_epochs=5, max_keep_ckpt=20, max_length=275, max_steps=None, min_epochs=None, min_steps=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', negative_sampling=False, num_labels=1, num_nodes=1, num_processes=1, num_sanity_val_steps=2, only_keep_the_best_ckpt_after_training=False, optimizer='torch.adam', output_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', overfit_batches=0.0, overwrite_cache=False, plugins=None, precision=16, pred_answerable=True, prepare_data_per_node=True, pretrained_checkpoint='', process_position=0, profiler=None, progress_bar_refresh_rate=1, reload_dataloaders_every_epoch=False, replace_sampler_ddp=True, resume_from_checkpoint=None, save_predictions_to_file=False, seed=2333, span_loss_candidates='gold_pred_random', stochastic_weight_avg=False, sync_batchnorm=False, terminate_on_nan=False, tpu_cores=<function _gpus_arg_default at 0x7f3aec438ca0>, track_grad_norm=-1, train_batch_size=10, truncated_bptt_steps=None, val_check_interval=0.25, warmup_proportion=0.02, weight_decay=0.002, weight_end=1.0, weight_span=0.2, weight_start=1.0, weights_save_path=None, weights_summary='top', workers=0)
2021-04-11 22:36:09,132 - __main__ - Namespace(accelerator=None, accumulate_grad_batches=3, activate_func='relu', adam_epsilon=1e-06, amp_backend='native', amp_level='O2', answerable_only=False, answerable_task_ratio=0.3, auto_lr_find=False, auto_scale_batch_size=False, auto_select_gpus=False, automatic_optimization=None, benchmark=False, bert_config_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/cached_models/bert-base-uncased', bert_hidden_dropout=0.1, cache_dir='', check_val_every_n_epoch=1, checkpoint_callback=True, construct_entity_span='start_and_end', data_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/datasets/zh_msra', data_sign='zh_msra', debug=False, default_root_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', deterministic=False, dice_alpha=0.01, dice_ohem=0.3, dice_smooth=1.0, dice_square=True, distributed_backend=None, do_lower_case=False, enable_pl_optimizer=None, eval_batch_size=1, fast_dev_run=False, final_div_factor=10000.0, flat_ner=True, flush_logs_every_n_steps=100, focal_alpha=None, focal_gamma=2, gpus='0,', gradient_clip_val=1.0, is_chinese=True, limit_predict_batches=1.0, limit_test_batches=1.0, limit_train_batches=1.0, limit_val_batches=1.0, log_every_n_steps=50, log_gpu_memory=None, logger=True, loss_dynamic=False, loss_type='dice', lr=2e-05, lr_scheduler='polydecay', max_epochs=5, max_keep_ckpt=20, max_length=275, max_steps=None, min_epochs=None, min_steps=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', negative_sampling=False, num_labels=1, num_nodes=1, num_processes=1, num_sanity_val_steps=2, only_keep_the_best_ckpt_after_training=False, optimizer='torch.adam', output_dir='/home/xiangpan/Labs/CovidQA/dice_loss_for_NLP/outputs/dice_loss/mrc_ner/reproduce_zhmsra_dice_base_10_275_2e-5_polydecay_0.1_3_5_1.0_0.002_0.02_1_1_0.2_dice_1_0.3_0.01', overfit_batches=0.0, overwrite_cache=False, plugins=None, precision=16, pred_answerable=True, prepare_data_per_node=True, pretrained_checkpoint='', process_position=0, profiler=None, progress_bar_refresh_rate=1, reload_dataloaders_every_epoch=False, replace_sampler_ddp=True, resume_from_checkpoint=None, save_predictions_to_file=False, seed=2333, span_loss_candidates='gold_pred_random', stochastic_weight_avg=False, sync_batchnorm=False, terminate_on_nan=False, tpu_cores=<function _gpus_arg_default at 0x7fb5d55aeca0>, track_grad_norm=-1, train_batch_size=10, truncated_bptt_steps=None, val_check_interval=0.25, warmup_proportion=0.02, weight_decay=0.002, weight_end=1.0, weight_span=0.2, weight_start=1.0, weights_save_path=None, weights_summary='top', workers=0)
2021-04-11 22:36:15,796 - __main__ - EVAL INFO -> current_epoch is: 0, current_global_step is: 0 
2021-04-11 22:36:15,796 - __main__ - EVAL INFO -> valid_f1 is: 0.0; precision: 0.0, recall: 0.0.
2021-04-11 22:36:29,894 - __main__ - =&=&=&=&=&=&=&=&=&=&=&=&=&=&=&=&=&=&=&=&
2021-04-11 22:36:29,894 - __main__ - Best F1 on DEV is 0
2021-04-11 22:36:29,894 - __main__ - Best checkpoint on DEV set is 
